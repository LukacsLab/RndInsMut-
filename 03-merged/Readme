I noticed that the merged function merges the reads keeping the longest possible overlap with the genome. This sounds reasonable, however I have seen cases where one or two bases of a poorly trimmed adapter (doesn't happen often, but does happen) are merged and kept as the starting position of our insertion. 
In order to obtain an accurate insertion position, I am merging and keeping the median of the starting and end positions instead, ensuring that for both insertions in the positive and negative strands I am keeping the exact start position (useful when comparing clones to each other, as I can tell if the insertion happened in the same spot). This code is only robbust when we have a reasonable number of reads for a certain insertion (a single read with slight alignment of the adapter would not have the start position identified correctly).
This code also obtains the strand of the insertion (refered as polarity), so that we know in which direction the promoter/enhancer is oriented.
The perl code getClusters_CPM.pl allows obtaining the clusters of insertions for each group of clones. This code was writen by Elton and edited by Julia. This code is currently not being used in the pipeline, as the clusters are being obtained in the matlab code uploaded in the folder 04-cluster.  
